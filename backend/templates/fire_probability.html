<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Fire Detection | Smart Home</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Orbitron', sans-serif;
            min-height: 100vh;
            background:
                radial-gradient(circle at top, rgba(255,60,0,0.35), transparent 45%),
                linear-gradient(135deg, #0b0f17, #1a0505);
            color: #fff;
        }

        .glass {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(18px);
            border-radius: 22px;
            box-shadow: 0 30px 70px rgba(0,0,0,0.7);
            padding: 35px;
        }

        .fire-title {
            color: #ff5722;
            text-shadow: 0 0 15px rgba(255,87,34,0.6);
        }

        .sensor-input {
            background: rgba(0,0,0,0.45);
            border: 1px solid rgba(255,255,255,0.2);
            color: white !important;
        }

        .sensor-input:focus {
            border-color: #ff5722;
            box-shadow: 0 0 12px #ff5722;
            background: rgba(0,0,0,0.6);
        }

        .btn-fire {
            background: linear-gradient(135deg, #ff512f, #dd2476);
            border: none;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .btn-fire:hover {
            transform: scale(1.03);
            box-shadow: 0 0 20px rgba(255,80,0,0.6);
        }

        .status-safe { color: #00ff99; }
        .status-warning { color: #ffcc00; }
        .status-danger {
            color: #ff3b3b;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-10">

            <div class="glass">
                <div class="text-center mb-4">
                    <h2 class="fire-title fw-bold">ðŸ”¥ AI Fire Detection System</h2>
                </div>

                <!-- Two-column layout: left = inputs, right = chart/result -->
                <div class="row">
                    <!-- LEFT: INPUT FIELDS -->
                    <div class="col-md-6">
                        <form method="post">
                            {% csrf_token %}

                            <div class="mb-3">
                                <label class="form-label">Temperature (Â°C)</label>
                                <input type="number" step="0.01" name="temperature" class="form-control sensor-input" required>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Humidity (%)</label>
                                <input type="number" step="0.01" name="humidity" class="form-control sensor-input" required>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Smoke Level</label>
                                <input type="number" step="0.01" name="smoke" class="form-control sensor-input" required>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Gas Level</label>
                                <input type="number" step="0.01" name="gas" class="form-control sensor-input" required>
                            </div>

                            <div class="d-grid mt-3">
                                <button type="submit" class="btn btn-fire btn-lg text-white">
                                    ðŸš¨ Analyze Fire Risk
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- RIGHT: RESULT -->
                    <div class="col-md-6">
                        {% if fire_probability is not None %}
                        <div class="text-center mb-3 position-relative">
                            <!-- Smaller chart: 200x200 instead of 250x250 -->
                            <canvas id="fireChart" width="200" height="200"></canvas>
                            <!-- Center text inside chart -->
                            <div id="chartCenterText" style="
                                position: absolute;
                                top: 50%;
                                left: 50%;
                                transform: translate(-50%, -50%);
                                text-align: center;
                                pointer-events: none;
                            ">
                                <div style="font-size: 1rem;">ðŸ”¥ Fire Risk Status</div>
                                <div style="font-size: 1.2rem; font-weight: 600;">
                                    {% if fire_probability < 30 %}
                                        <span class="status-safe">SAFE â€” {{ fire_probability }}%</span>
                                    {% elif fire_probability < 70 %}
                                        <span class="status-warning">WARNING â€” {{ fire_probability }}%</span>
                                    {% else %}
                                        <span class="status-danger">ðŸ”¥ DANGER â€” {{ fire_probability }}%</span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <script>
                            const fireProbability = {{ fire_probability }};
                            new Chart(document.getElementById('fireChart'), {
                                type: 'doughnut',
                                data: {
                                    labels: ['Fire Risk', 'Safe Zone'],
                                    datasets: [{
                                        data: [fireProbability, 100 - fireProbability],
                                        backgroundColor: [
                                            fireProbability < 30 ? '#00ff99' :
                                            fireProbability < 70 ? '#ffcc00' : '#ff3b3b',
                                            'rgba(255,255,255,0.15)'
                                        ],
                                        borderWidth: 0
                                    }]
                                },
                                options: {
                                    cutout: '70%',
                                    plugins: { legend: { display: false } }
                                }
                            });
                        </script>
                        {% endif %}
                    </div>
                </div>

            </div>

        </div>
    </div>
</div>

</body>
</html>
